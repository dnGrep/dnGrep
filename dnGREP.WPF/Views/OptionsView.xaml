<my:ThemedWindow x:Class="dnGREP.WPF.OptionsView"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:l="clr-namespace:dnGREP.Localization;assembly=dnGREP.Localization"
                 xmlns:my="clr-namespace:dnGREP.WPF"
                 mc:Ignorable="d"
                 Title="{l:Loc Key='Options_OptionsTitle'}"
                 MinWidth="500"
                 MinHeight="300"
                 d:DesignHeight="4000"
                 FlowDirection="{Binding CultureFlowDirection}"
                 FontFamily="{Binding ApplicationFontFamily}"
                 FontSize="{Binding DialogFontSize}"
                 my:DiginesisHelpProvider.HelpKeyword="Options"
                 my:DiginesisHelpProvider.HelpNavigator="Topic"
                 my:DiginesisHelpProvider.ShowHelp="True"
                 ResizeMode="CanResize"
                 SizeToContent="Width"
                 my:ChromeButtonExtension.ButtonVisibility="MinimizeHidden"
                 Background="{DynamicResource Dialog.Background}"
                 CaptionBackground="{DynamicResource Caption.Dialog.Background}"
                 Icon="/dnGREP;component/nGREP.ico"
                 WindowStartupLocation="CenterOwner"
                 my:InputBindingsBehavior.InputBindings="{Binding InputBindings}" >

    <Window.Resources>
        <my:EnumBooleanConverter x:Key="ebc" />
        <my:InverseBooleanConverter x:Key="not" />
        <my:TextBoxWidthConverter x:Key="TextBoxWidthConverter"/>
        <my:DoubleToStringConverter x:Key="doubleToString"/>
        <my:LongToStringConverter x:Key="longToString"/>
        <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource LabelTextBlockStyle}" />

        <Style TargetType="{x:Type GroupBox}" BasedOn="{StaticResource ThemedGroupBox}">
            <Setter Property="Margin" Value="0,12" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GroupBox}">
                        <Grid SnapsToDevicePixels="True">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="B" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <Border x:Name="Header" Grid.Column="0" Margin="0,6,30,0"
                                    Padding="0">
                                <ContentPresenter HorizontalAlignment="Right"
                                                  ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                  Content="{TemplateBinding Header}"
                                                  ContentStringFormat="{TemplateBinding HeaderStringFormat}"
                                                  ContentSource="Header" RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <ContentPresenter Grid.Column="1"
                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                              Content="{TemplateBinding Content}"
                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />

                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <CollectionViewSource x:Key="mainWindowControlGroups"
                          Source="{Binding Path=VisibilityOptions}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Group" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>


    <Grid Margin="12,0,0,0" Grid.IsSharedSizeScope="True">
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <ScrollViewer Grid.Row="0" PanningMode="Both" HorizontalScrollBarVisibility="Auto">
            <StackPanel HorizontalAlignment="Stretch">

                <GroupBox Header="{l:Loc Key='Options_StartupOptions'}">
                    <StackPanel Orientation="Vertical">
                        <Label Content="{l:Loc Key='Options_ShowDnGrepInExplorerRightClickMenu'}"
                               ToolTip="{l:Loc Key='Options_EnablesStartingDnGrepFromTheWindowsExplorerRightClickContextMenu'}"/>
                        <Border ToolTip="{Binding EnableWindows11ShellMenuTooltip}" Margin="24,0,0,0">
                            <CheckBox Margin="0,3"
                                      IsChecked="{Binding Path=EnableWindows11ShellMenu}" 
                                      IsEnabled="{Binding Path=CanModifyWindows11ShellMenu}">
                                <CheckBox.Content>
                                    <TextBlock>
                                        <Run Text="{l:Loc Key='Options_NewRightClickMenu'}"/><Run>&#160;</Run>
                                        <Run FontWeight="Bold" Text="{l:Loc Key='ShellMenu_SearchWithDnGrep'}"/>
                                    </TextBlock>
                                </CheckBox.Content>
                            </CheckBox>
                        </Border>
                        <Border ToolTip="{Binding Path=PanelTooltip}" Margin="24,0,0,0">
                            <CheckBox Margin="0,3"
                                      IsChecked="{Binding Path=EnableWindowsIntegration}"
                                      IsEnabled="{Binding Path=IsAdministrator}">
                                <CheckBox.Content>
                                    <TextBlock>
                                        <Run Text="{l:Loc Key='Options_OriginalRightClickMenu'}"/><Run>&#160;</Run>
                                        <Run FontWeight="Bold">dnGrep...</Run>
                                    </TextBlock>
                                </CheckBox.Content>
                            </CheckBox>
                        </Border>
                        <CheckBox Margin="0,6,0,3" Content="{l:Loc Key='Options_ReuseExistingWindow'}"
                                  IsChecked="{Binding Path=IsSingletonInstance}" />
                        <CheckBox Margin="24,3,0,3" Content="{l:Loc Key='Options_ForwardCommandLineArgumentsToTheExistingWindow'}"
                                  IsChecked="{Binding Path=PassCommandLineToSingleton}"
                                  IsEnabled="{Binding IsSingletonInstance}"/>
                        <CheckBox Margin="0,6,0,3" Content="{l:Loc Key='Options_MinimizeToNotificationArea'}"
                                  IsChecked="{Binding Path=MinimizeToNotificationArea}" />
                        <Label Content="{l:Loc Key='Options_KeyboardShortcutToRestoreWindow'}"/>
                        <TextBox Margin="24,0,0,3" Width="300" HorizontalAlignment="Left"
                                 Text="{Binding LocalizedRestoreWindowKeyboardShortcut}" 
                                 PreviewKeyDown="TextBox_PreviewKeyDown"/>
                        <Label Margin="0,3" Content="{l:Loc Key='Options_RestartRequiredWhenChanged'}"
                               Style="{StaticResource ThemedLabel}"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_Exit'}">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Content="{l:Loc Key='Options_AskForConfirmationOnExitWhenScriptIsRunning'}"
                                  IsChecked="{Binding Path=ConfirmExitScript}" />
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Margin="0,0,3,0" Content="{l:Loc Key='Options_AskForConfirmationOnExitWhenSearchRunsLongerThan'}"
                                      IsChecked="{Binding Path=ConfirmExitSearch}" />
                            <TextBox Margin="3,0,0,0">
                                <TextBox.Text>
                                    <Binding Path="ConfirmExitSearchDuration" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged"
                                         Converter="{StaticResource doubleToString}">
                                        <Binding.ValidationRules>
                                            <my:ValueRangeRule Min="0" Max="10000"/>
                                        </Binding.ValidationRules>
                                    </Binding>
                                </TextBox.Text>
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <Label Margin="1,0" Content="{l:Loc Key='Options_Minutes'}"/>
                        </StackPanel>

                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_CheckingForUpdates'}">
                    <StackPanel Orientation="Vertical">
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Margin="0,0,3,0" Name="cbCheckForUpdates" Content="{l:Loc Key='Options_EnableAutomaticCheckingEvery'}"
                                  IsChecked="{Binding Path=EnableCheckForUpdates}" />
                            <TextBox Margin="3,0,0,0"
                                 IsEnabled="{Binding ElementName=cbCheckForUpdates, Path=IsChecked}"
                                 Text="{Binding Path=CheckForUpdatesInterval, UpdateSourceTrigger=PropertyChanged}">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <Label Margin="3,0" Content="{l:Loc Key='Options_CheckDays'}" />
                        </StackPanel>
                        <Border ToolTip="{Binding Path=PanelTooltip}" Margin="24,3">
                            <CheckBox Content="{l:Loc Key='Options_CheckForUpdatesWhenWindowsStarts'}"
                                      IsChecked="{Binding Path=EnableRunAtStartup}"
                                      IsEnabled="{Binding Path=CanChangeRunAtStartup }"/>
                        </Border>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_Theme'}">
                    <StackPanel>
                        <CheckBox Margin="0,6,0,3" Content="{l:Loc Key='Options_FollowWindowsTheme'}"
                                  IsChecked="{Binding Path=FollowWindowsTheme}"
                                  IsEnabled="{Binding Path=HasWindowsThemes}" />
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Margin="0,3" Text="{l:Loc Key='Options_SelectedTheme'}" />
                            <ComboBox Margin="6,3"
                                      ItemsSource="{Binding Path=ThemeNames}"
                                      SelectedValue="{Binding Path=CurrentTheme}"
                                      IsEnabled="{Binding Path=FollowWindowsTheme, Converter={StaticResource not}}">
                                <ComboBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="200" FallbackValue="200">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </ComboBox.Width>
                            </ComboBox>
                            <Button Margin="6,3" Padding="12,3" Content="{l:Loc Key='Options_Reload'}"
                                    Command="{Binding ReloadThemeCommand}"
                                    ToolTip="{Binding ReloadThemeCommandTooltip}" />
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_Language'}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <ComboBox Margin="3,3"
                                      ItemsSource="{Binding Path=CultureNames}"
                                      SelectedValuePath="Key"
                                      DisplayMemberPath="Value"
                                      SelectedValue="{Binding Path=CurrentCulture, Mode=TwoWay}">
                                <ComboBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="250" FallbackValue="250">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </ComboBox.Width>
                            </ComboBox>
                            <Button Margin="6,3" Padding="12,3" 
                                    Content="{l:Loc Key='Options_LoadFromFile'}"
                                    ToolTip="{l:Loc Key='Options_PreviewToolForTranslators'}"
                                    Command="{Binding LoadResxCommand}"/>
                        </StackPanel>
                        <TextBlock>
                            <Run Text="{l:Loc Key='Options_WantADifferentLanguage'}"/>
                            <Hyperlink NavigateUri="https://github.com/dnGrep/dnGrep/wiki/Translate-dnGrep" 
                                       RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="{l:Loc Key='Options_HelpTranslateDnGrep'}"/>
                            </Hyperlink>
                        </TextBlock>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_ApplicationFonts'}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <CheckBox Grid.Row="0" Grid.ColumnSpan="2" Margin="0,6,0,3" Content="{l:Loc Key='Options_UseDefault'}"
                                  IsChecked="{Binding Path=UseDefaultFont}" />
                        <TextBlock Grid.Row="1" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_FontFamily'}" />
                        <ComboBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Margin="6,3"
                                  HorizontalAlignment="Left"
                                  ItemsSource="{Binding Path=FontFamilies}"
                                  DisplayMemberPath="FamilyName"
                                  SelectedValuePath="FamilyName"
                                  SelectedValue="{Binding Path=EditApplicationFontFamily}"
                                  IsEnabled="{Binding Path=UseDefaultFont, Converter={StaticResource not}}">
                            <ComboBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="200" FallbackValue="200">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </ComboBox.Width>
                        </ComboBox>

                        <TextBlock Grid.Row="2" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_MainFontSize'}" />
                        <TextBox Grid.Row="2" Grid.Column="1" Margin="6,3"
                                 IsEnabled="{Binding Path=UseDefaultFont, Converter={StaticResource not}}">
                            <TextBox.Text>
                                <Binding Path="EditMainFormFontSize" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource doubleToString}">
                                    <Binding.ValidationRules>
                                        <my:ValueRangeRule Min="8" Max="24"/>
                                    </Binding.ValidationRules>
                                </Binding>
                            </TextBox.Text>
                            <TextBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </TextBox.Width>
                        </TextBox>
                        <TextBlock Grid.Row="2" Grid.Column="2" Margin="12,3" Text="{l:Loc Key='Options_SampleText'}"
                                   FontFamily="{Binding Path=EditApplicationFontFamily}"
                                   FontSize="{Binding Path=EditMainFormFontSize}"/>

                        <TextBlock Grid.Row="3" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_ReplaceFontSize'}" />
                        <TextBox Grid.Row="3" Grid.Column="1" Margin="6,3"
                                 IsEnabled="{Binding Path=UseDefaultFont, Converter={StaticResource not}}">
                            <TextBox.Text>
                                <Binding Path="EditReplaceFormFontSize" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource doubleToString}">
                                    <Binding.ValidationRules>
                                        <my:ValueRangeRule Min="8" Max="24"/>
                                    </Binding.ValidationRules>
                                </Binding>
                            </TextBox.Text>
                            <TextBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </TextBox.Width>
                        </TextBox>
                        <TextBlock Grid.Row="3" Grid.Column="2" Margin="12,3" Text="{l:Loc Key='Options_SampleText'}"
                                   FontFamily="{Binding Path=EditApplicationFontFamily}"
                                   FontSize="{Binding Path=EditReplaceFormFontSize}"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_DialogFontSize'}" />
                        <TextBox Grid.Row="4" Grid.Column="1" Margin="6,3"
                                 IsEnabled="{Binding Path=UseDefaultFont, Converter={StaticResource not}}">
                            <TextBox.Text>
                                <Binding Path="EditDialogFontSize" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource doubleToString}">
                                    <Binding.ValidationRules>
                                        <my:ValueRangeRule Min="8" Max="24"/>
                                    </Binding.ValidationRules>
                                </Binding>
                            </TextBox.Text>
                            <TextBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </TextBox.Width>
                        </TextBox>
                        <TextBlock Grid.Row="4" Grid.Column="2" Margin="12,3" Text="{l:Loc Key='Options_SampleText'}"
                                   FontFamily="{Binding Path=EditApplicationFontFamily}"
                                   FontSize="{Binding Path=EditDialogFontSize}"/>

                        <TextBlock Grid.Row="5" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_ResultsFontFamily'}" 
                                   ToolTip="{l:Loc Key='Options_ResultsFontUsuallyAFixedWidthFont'}"/>
                        <ComboBox Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="2" Margin="6,3"
                                  HorizontalAlignment="Left"
                                  ItemsSource="{Binding Path=FontFamilies}"
                                  SelectedValuePath="FamilyName"
                                  SelectedValue="{Binding Path=EditResultsFontFamily}"
                                  IsEnabled="{Binding Path=UseDefaultFont, Converter={StaticResource not}}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding FamilyName}">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsMonospaced}" Value="True">
                                                        <Setter Property="FontWeight" Value="Bold"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                            <ComboBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="200" FallbackValue="200">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </ComboBox.Width>
                        </ComboBox>

                        <TextBlock Grid.Row="6" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_ResultsFontSize'}" />
                        <TextBox Grid.Row="6" Grid.Column="1" Margin="6,3"
                                 IsEnabled="{Binding Path=UseDefaultFont, Converter={StaticResource not}}">
                            <TextBox.Text>
                                <Binding Path="EditResultsFontSize" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource doubleToString}">
                                    <Binding.ValidationRules>
                                        <my:ValueRangeRule Min="8" Max="24"/>
                                    </Binding.ValidationRules>
                                </Binding>
                            </TextBox.Text>
                            <TextBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </TextBox.Width>
                        </TextBox>
                        <TextBlock Grid.Row="6" Grid.Column="2" Margin="12,3" Text="{l:Loc Key='Options_SampleText'}"
                                   FontFamily="{Binding Path=EditResultsFontFamily}"
                                   FontSize="{Binding Path=EditResultsFontSize}"/>

                        <TextBlock Grid.Row="7" Grid.Column="0" Margin="0,3" 
                                   HorizontalAlignment="Right" Text="{l:Loc Key='Options_ResultsFontWeight'}"
                                   ToolTip="{l:Loc Key='Options_ForFileNameInSearchResults'}"/>
                        <ComboBox Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="2" Margin="6,3"
                                  HorizontalAlignment="Left"
                                  ItemsSource="{Binding Path=FontWeightList}"
                                  SelectedValue="{Binding Path=ResultsFileNameWeight}"
                                  ToolTip="{l:Loc Key='Options_ForFileNameInSearchResults'}">
                        <ComboBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="100" FallbackValue="100">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </ComboBox.Width>
                        </ComboBox>

                    </Grid>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_CustomEditor'}">
                    <StackPanel Orientation="Vertical">
                        <Button Content="{l:Loc Key='Options_EditorAdd'}"
                                Command="{Binding AddCustomEditorCommand}"
                                Padding="12,1" Margin="3,0" 
                                HorizontalAlignment="Left" VerticalAlignment="Center"/>

                        <ItemsControl ItemsSource="{Binding Path=CustomEditors}" Grid.IsSharedSizeScope="True">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" SharedSizeGroup="C1"/>
                                            <ColumnDefinition Width="Auto" SharedSizeGroup="C2"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/>
                                            <RowDefinition/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                                   FontWeight="Bold" Margin="0,3,6,3"
                                                   Text="{Binding Label}" 
                                                   ToolTip="{Binding Path}"/>
                                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                                            <Button Content="{l:Loc Key='Options_EditorEdit'}"
                                                    Command="{Binding EditCustomEditorCommand}"
                                                    Padding="12,1" Margin="3,0" 
                                                    HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                            <Button Content="{l:Loc Key='Options_EditorDelete'}"
                                                    Command="{Binding DeleteCustomEditorCommand}"
                                                    Padding="12,1" Margin="3,0" 
                                                    HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" 
                                                   Text="{Binding ExtensionSummary}" Margin="0,3,6,3"/>

                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_CompareApplication'}">
                    <Grid Margin="0,0,12,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="440" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Row="0" Grid.Column="0" Margin="3"
                                   Text="{l:Loc Key='Options_CompareCommand'}" />
                        <TextBox Grid.Row="0" Grid.Column="1" Margin="3"
                                 Text="{Binding Path=CompareApplicationPath, UpdateSourceTrigger=PropertyChanged}" />
                        <Button Grid.Column="2" Content="{l:Loc Key='Options_BrowseFileLocation'}" Margin="3"
                                Command="{Binding Path=BrowseCompareCommand}">
                            <Button.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </Button.Width>
                        </Button>
                        <TextBlock Grid.Row="1" Grid.Column="0" Margin="3"
                                   Text="{l:Loc Key='Options_CompareArguments'}" />
                        <TextBox Grid.Row="1" Grid.Column="1" Margin="3"
                                 Text="{Binding Path=CompareApplicationArgs, UpdateSourceTrigger=PropertyChanged}" />
                        <ComboBox Grid.Row="2" Grid.Column="1" HorizontalAlignment="Left" Margin="3"
                                  ItemsSource="{Binding Path=CompareApplicationTemplates}"
                                  DisplayMemberPath="Key"
                                  SelectedValuePath="Value"
                                  SelectedValue="{Binding Path=CompareApplicationTemplate}">
                            <ComboBox.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="150" FallbackValue="150">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </ComboBox.Width>
                        </ComboBox>
                        <TextBlock Grid.Row="3" Grid.Column="1" TextWrapping="Wrap" Margin="3" 
                                   Text="{l:Loc Key='Options_DnGrepWillAddTheSelectedFiles'}"/>
                    </Grid>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_SearchOptions'}">
                    <StackPanel Margin="0,3,0,0">
                        <CheckBox Content="{l:Loc Key='Options_EnableAutocompleteInTextInputBoxes'}" Margin="3"
                                  IsChecked="{Binding AutoCompleteEnabled}"/>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Label Grid.Row="0" Grid.Column="0" 
                                   Content="{l:Loc Key='Options_NumberOfMatchesToAutoStopSearch'}"/>
                            <TextBox Grid.Row="0" Grid.Column="1" Margin="3,0"
                                     HorizontalContentAlignment="Right">
                                <TextBox.Text>
                                    <Binding Path="SearchAutoStopCount" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250">
                                        <Binding.ValidationRules>
                                            <my:ValueRangeRule Min="1" Max="100000"/>
                                        </Binding.ValidationRules>
                                    </Binding>
                                </TextBox.Text>
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>

                            <Label Grid.Row="1" Grid.Column="0"
                                   Content="{l:Loc Key='Options_NumberOfMatchesToAutoPauseSearch'}"/>
                            <TextBox Grid.Row="1" Grid.Column="01" Margin="3,0"
                                     HorizontalContentAlignment="Right">
                                <TextBox.Text>
                                    <Binding Path="SearchAutoPauseCount" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250">
                                        <Binding.ValidationRules>
                                            <my:ValueRangeRule Min="1" Max="100000"/>
                                        </Binding.ValidationRules>
                                    </Binding>
                                </TextBox.Text>
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                        </Grid>
                        
                        <Label Content="{l:Loc Key='Options_MaximumNumberOfParallelSearches'}"/>
                        <StackPanel Orientation="Horizontal">
                            <Slider Width="250" HorizontalAlignment="Left"
                                    Minimum="1" Maximum="{Binding TaskLimit}" 
                                    AutoToolTipPlacement="BottomRight"
                                    TickPlacement="BottomRight"
                                    Value="{Binding ParallelismCount}"/>
                            <CheckBox Margin="12,0" Content="{l:Loc Key='Options_NoFixedLimit'}"
                                      IsChecked="{Binding ParallelismUnlimited}"/>
                        </StackPanel>

                        <StackPanel Orientation="Vertical">
                            <Label Content="{l:Loc Key='Options_SetKeyboardFocusTo'}"/>
                            <RadioButton Content="{l:Loc Key='Options_FocusResultsTree'}" 
                                         Margin="18,3" GroupName="FocusElement"
                                         IsChecked="{Binding FocusElement, Converter={StaticResource ebc}, ConverterParameter=ResultsTree}" />
                            <RadioButton Content="{l:Loc Key='Options_FocusSearchFor'}" 
                                         Margin="18,3" GroupName="FocusElement"
                                         IsChecked="{Binding FocusElement, Converter={StaticResource ebc}, ConverterParameter=SearchFor}" />
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_ResultsOptions'}">
                    <StackPanel Margin="0,3,0,0">
                        <CheckBox Margin="3" Content="{l:Loc Key='Options_EnableStickyScrollInResultsTree'}"
                                  IsChecked="{Binding Path=StickyScroll}" />
                        <CheckBox Margin="3" Content="{l:Loc Key='Options_SortResultsAutomaticallyWhenSearchCompletes'}"
                                  IsChecked="{Binding Path=SortAutomaticallyOnSearch}" />
                        <CheckBox Margin="3" Content="{l:Loc Key='Options_MaximizeResultsPanelOnSearch'}"
                                  IsChecked="{Binding Path=MaximizeResultsTreeOnSearch}" />
                        <CheckBox Margin="3" Content="{l:Loc Key='Options_ShowFilesWithSearchErrorsInResultsPanel'}"
                                  IsChecked="{Binding Path=ShowFileErrorsInResults}" />
                        <CheckBox Name="cbShowPath" Margin="3" Content="{l:Loc Key='Options_ShowFilePathInResultsPanel'}"
                                  IsChecked="{Binding Path=ShowFilePathInResults}" />
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Name="cbShowContext" Margin="3" HorizontalAlignment="Center"
                                      IsChecked="{Binding Path=ShowLinesInContext}" 
                                      Content="{l:Loc Key='Options_ShowResultLinesInContext'}"/>
                            <TextBox Margin="3,0,0,0"
                                     Text="{Binding Path=ContextLinesBefore, UpdateSourceTrigger=PropertyChanged}">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <Label Content="{l:Loc Key='Options_ContextBeforeAnd'}" />
                            <TextBox Text="{Binding Path=ContextLinesAfter, UpdateSourceTrigger=PropertyChanged}">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <Label Content="{l:Loc Key='Options_ContextAfter'}" />
                        </StackPanel>

                        <CheckBox Name="cbSearchFileNameOnly" Margin="3" 
                                  Content="{l:Loc Key='Options_AllowSearchingForFileNamePatternOnly'}"
                                  IsChecked="{Binding Path=AllowSearchWithEmptyPattern}"/>

                        <CheckBox Name="cbCheckEncoding" Margin="3"
                                  Content="{l:Loc Key='Options_DetectFileEncodingWhenSearchingForFileNamePatternOnly'}"
                                  IsChecked="{Binding Path=DetectEncodingForFileNamePattern}"/>

                        <CheckBox Name="cbExpandResult" Margin="3" 
                                  Content="{l:Loc Key='Options_ShowResultsTreeExpanded'}"
                                  IsChecked="{Binding Path=AutoExpandSearchTree}" />

                        <CheckBox Name="cbShowMatchVerbose" Margin="3" 
                                  Content="{l:Loc Key='Options_ShowVerboseMatchCount'}"
                                  IsChecked="{Binding Path=ShowVerboseMatchCount}" />

                        <CheckBox Name="cbShowFileInfoToolTips" Margin="3" 
                                  Content="{l:Loc Key='Options_ShowFileInfoToolTips'}"
                                  IsChecked="{Binding Path=ShowFileInfoTooltips}" />

                        <StackPanel Orientation="Horizontal">
                            <Label Content="{l:Loc Key='Options_HexSearchResultLineLength'}"/>
                            <ComboBox Margin="3"
                                ItemsSource="{Binding Path=HexLengthOptions}"
                                Width="60"
                                SelectedValue="{Binding Path=HexResultByteLength, Mode=TwoWay}"/>
                        </StackPanel>

                        <StackPanel Orientation="Vertical">
                            <Label Content="{l:Loc Key='Optionss_AskBeforeLoadingFiles'}"/>
                            <StackPanel Orientation="Horizontal" Margin="16,0,0,3">
                                <TextBox Margin="3,0,0,0" HorizontalContentAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="PreviewLargeFileLimit" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource longToString}">
                                            <Binding.ValidationRules>
                                                <my:ValueRangeRuleLong Min="0" Max="10000000"/>
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                    <TextBox.Width>
                                        <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="72" FallbackValue="72">
                                            <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                            <Binding Path="ApplicationFontFamily"/>
                                            <Binding Path="DialogFontSize"/>
                                        </MultiBinding>
                                    </TextBox.Width>
                                </TextBox>
                                <Label Content="{l:Loc Key='Options_KB'}"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Directories">
                    <Grid Margin="0,6,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="500"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <CheckBox Grid.Row="0" Grid.Column="0" Margin="0,3"
                                  Content="Use default directories"
                                  IsChecked="{Binding PathsAreDefault}"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Margin="12,3,3,3" 
                                   Text="Application configuration and data:" />

                        <TextBox Grid.Row="2" Grid.Column="0" Margin="20,3,3,3"
                                 Text="{Binding Path=DataDirectoryPath, UpdateSourceTrigger=PropertyChanged}"
                                 IsReadOnly="{Binding PathsAreDefault}"/>

                        <Button Grid.Row="2" Grid.Column="1" Margin="3"
                                Content="{l:Loc Key='Options_BrowseFileLocation'}"
                                Command="{Binding Path=BrowseDataDirectory}"
                                IsEnabled="{Binding PathsAreDefault, Converter={StaticResource not}}">
                            <Button.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </Button.Width>
                        </Button>

                        <TextBlock Grid.Row="3" Grid.Column="0" Margin="12,3,3,3" 
                                   Text="Application log files:" />

                        <TextBox Grid.Row="4" Grid.Column="0" Margin="20,3,3,3"
                                 Text="{Binding Path=LogDirectoryPath, UpdateSourceTrigger=PropertyChanged}"
                                 IsReadOnly="{Binding PathsAreDefault}"/>

                        <Button Grid.Row="4" Grid.Column="1" Margin="3"
                                Content="{l:Loc Key='Options_BrowseFileLocation'}"
                                Command="{Binding Path=BrowseLogDirectory}"
                                IsEnabled="{Binding PathsAreDefault, Converter={StaticResource not}}">
                            <Button.Width>
                                <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                    <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                    <Binding Path="ApplicationFontFamily"/>
                                    <Binding Path="DialogFontSize"/>
                                </MultiBinding>
                            </Button.Width>
                        </Button>
                    </Grid>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_Layout'}">
                    <StackPanel>
                        <StackPanel Margin="0,6,0,0">
                            <TextBlock Text="{l:Loc Key='Options_ShowSearchOptions'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_OnMainPanel'}" GroupName="searchLocation"
                                         IsChecked="{Binding OptionsLocation, Converter={StaticResource ebc}, ConverterParameter=MainPanel}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_InOptionsExpander'}" GroupName="searchLocation"
                                         IsChecked="{Binding OptionsLocation, Converter={StaticResource ebc}, ConverterParameter=OptionsExpander}" />
                        </StackPanel>
                        <StackPanel Margin="0,6,0,0">
                            <TextBlock Text="{l:Loc Key='Options_ReplaceDialogLayout'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_FilesAndIndividualMatches'}" GroupName="replaceLayout"
                                         IsChecked="{Binding ReplaceDialogLayout, Converter={StaticResource ebc}, ConverterParameter=FullDialog}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_FilesOnly'}" GroupName="replaceLayout"
                                         IsChecked="{Binding ReplaceDialogLayout, Converter={StaticResource ebc}, ConverterParameter=FilesOnly}" />
                        </StackPanel>

                        <CheckBox Margin="0,9,0,0" Content="{l:Loc Key='Options_ShowNavigationButtons'}"
                                  IsChecked="{Binding Path=NavigationButtonsVisible}" />
                        <TextBlock Text="{l:Loc Key='Options_ButtonSize'}" Margin="24,3,0,0"/>
                        <StackPanel Orientation="Horizontal" Margin="48,0,0,0"
                                    IsEnabled="{Binding Path=NavigationButtonsVisible}">
                            <RadioButton Content="{l:Loc Key='Options_Small'}" Margin="3" 
                                         IsChecked="{Binding NavigationToolsSize, Converter={StaticResource ebc}, ConverterParameter=Small}"/>
                            <RadioButton Content="{l:Loc Key='Options_Medium'}" Margin="3"
                                         IsChecked="{Binding NavigationToolsSize, Converter={StaticResource ebc}, ConverterParameter=Medium}"/>
                            <RadioButton Content="{l:Loc Key='Options_Large'}" Margin="3"
                                         IsChecked="{Binding NavigationToolsSize, Converter={StaticResource ebc}, ConverterParameter=Large}"/>
                        </StackPanel>
                        <TextBlock Text="{l:Loc Key='Options_PanelPosition'}" Margin="24,3,0,3"/>
                        <Grid Margin="48,0,0,0" HorizontalAlignment="Left"
                              IsEnabled="{Binding Path=NavigationButtonsVisible}">
                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="400"/>
                            </Grid.ColumnDefinitions>
                            <RadioButton Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="6" Margin="3"
                                         Content="{l:Loc Key='Options_AboveResultsTree'}"
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=Above}"/>
                            <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="6" Margin="3"
                                       Text="{l:Loc Key='Options_DockedToSideOfResultsTree'}"/>
                            <RadioButton Grid.Row="2" Grid.Column="1" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=TopLeft}"/>
                            <RadioButton Grid.Row="2" Grid.Column="2" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=TopCenter}"/>
                            <RadioButton Grid.Row="2" Grid.Column="3" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=TopRight}"/>

                            <RadioButton Grid.Row="3" Grid.Column="0" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=LeftTop}"/>
                            <RadioButton Grid.Row="4" Grid.Column="0" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=LeftCenter}"/>
                            <RadioButton Grid.Row="5" Grid.Column="0" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=LeftBottom}"/>

                            <RadioButton Grid.Row="3" Grid.Column="4" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=RightTop}"/>
                            <RadioButton Grid.Row="4" Grid.Column="4" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=RightCenter}"/>
                            <RadioButton Grid.Row="5" Grid.Column="4" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=RightBottom}"/>

                            <RadioButton Grid.Row="6" Grid.Column="1" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=BottomLeft}"/>
                            <RadioButton Grid.Row="6" Grid.Column="2" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=BottomCenter}"/>
                            <RadioButton Grid.Row="6" Grid.Column="3" Content=""
                                         IsChecked="{Binding NavigationToolsPosition, Converter={StaticResource ebc}, ConverterParameter=BottomRight}"/>
                        </Grid>

                        <StackPanel  Margin="0,16,0,0">
                            <TextBlock Text="{l:Loc Key='Options_PersonalizeControlVisibility'}" 
                                       ToolTip="{l:Loc Key='Options_PersonalizeControlVisibility_Tooltip'}" />
                            <ScrollViewer Height="280" Margin="18,3"
                                          HorizontalAlignment="Left"
                                          VerticalScrollBarVisibility="Auto"
                                          HorizontalScrollBarVisibility="Disabled">
                                <ItemsControl ItemsSource="{Binding Source={StaticResource mainWindowControlGroups}}">
                                    <ItemsControl.GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.ContainerStyle>
                                                <Style TargetType="{x:Type GroupItem}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                                                <StackPanel>
                                                                    <TextBlock Text="{Binding Name}"/>
                                                                    <ItemsPresenter Margin="18,3"/>
                                                                </StackPanel>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </GroupStyle.ContainerStyle>
                                        </GroupStyle>
                                    </ItemsControl.GroupStyle>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <CheckBox Content="{Binding Label}" IsChecked="{Binding IsVisible}"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_CopyFiles'}">
                    <StackPanel>
                        <CheckBox Margin="3,6,3,3" Content="{l:Loc Key='Options_PreserveSourceFolderLayout'}"
                                  IsChecked="{Binding PreserveFolderLayoutOnCopy}"/>
                        <Label Content="{l:Loc Key='Options_OnFileCopyOverwrite'}"/>
                        <StackPanel Orientation="Horizontal" Margin="12,0">
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_Yes'}" GroupName="copyOverwrite"
                                         IsChecked="{Binding CopyOverwriteFileOption, Converter={StaticResource ebc}, ConverterParameter=Yes}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_No'}" GroupName="copyOverwrite"
                                         IsChecked="{Binding CopyOverwriteFileOption, Converter={StaticResource ebc}, ConverterParameter=No}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_Ask'}" GroupName="copyOverwrite"
                                         IsChecked="{Binding CopyOverwriteFileOption, Converter={StaticResource ebc}, ConverterParameter=Prompt}"/>
                        </StackPanel>
                        <Label Content="{l:Loc Key='Options_WithFilesInArchives'}"/>
                        <StackPanel Orientation="Horizontal" Margin="12,0">
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_CopyTheWholeArchive'}" GroupName="copyArchive"
                                         IsChecked="{Binding ArchiveCopyOption, Converter={StaticResource ebc}, ConverterParameter=WholeArchive}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_ExtractAndCopyFiles'}" GroupName="copyArchive"
                                         IsChecked="{Binding ArchiveCopyOption, Converter={StaticResource ebc}, ConverterParameter=CopyFile}"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_MoveFiles'}">
                    <StackPanel>
                        <CheckBox Margin="3,6,3,3" Content="{l:Loc Key='Options_PreserveSourceFolderLayout'}"
                                  IsChecked="{Binding PreserveFolderLayoutOnMove}"/>
                        <Label Content="{l:Loc Key='Options_OnFileMoveOverwrite'}"/>
                        <StackPanel Orientation="Horizontal" Margin="12,0">
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_Yes'}" GroupName="moveOverwrite"
                                         IsChecked="{Binding MoveOverwriteFileOption, Converter={StaticResource ebc}, ConverterParameter=Yes}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_No'}" GroupName="moveOverwrite"
                                         IsChecked="{Binding MoveOverwriteFileOption, Converter={StaticResource ebc}, ConverterParameter=No}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_Ask'}" GroupName="moveOverwrite"
                                         IsChecked="{Binding MoveOverwriteFileOption, Converter={StaticResource ebc}, ConverterParameter=Prompt}"/>
                        </StackPanel>
                        <Label Content="{l:Loc Key='Options_WithFilesInArchives'}"/>
                        <StackPanel Orientation="Horizontal" Margin="12,0">
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_MoveTheWholeArchive'}" GroupName="moveArchive"
                                         IsChecked="{Binding ArchiveMoveOption, Converter={StaticResource ebc}, ConverterParameter=WholeArchive}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_ExtractAndMoveFiles'}" GroupName="moveArchive"
                                         IsChecked="{Binding ArchiveMoveOption, Converter={StaticResource ebc}, ConverterParameter=CopyFile}"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_DeleteFiles'}">
                    <StackPanel>
                        <StackPanel Margin="0,6,0,0">
                            <TextBlock Text="{l:Loc Key='Options_WhenDeletingFiles'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_SendToRecycleBin'}" GroupName="deleteFiles"
                                         IsChecked="{Binding DeleteOption, Converter={StaticResource ebc}, ConverterParameter=Recycle}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_DeletePermanently'}" GroupName="deleteFiles"
                                         IsChecked="{Binding DeleteOption, Converter={StaticResource ebc}, ConverterParameter=Permanent}" />
                        </StackPanel>
                        <Label Content="{l:Loc Key='Options_WithFilesInArchives'}"/>
                        <StackPanel Orientation="Horizontal" Margin="12,0">
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_DeleteTheWholeArchive'}" GroupName="deleteArchive"
                                         IsChecked="{Binding ArchiveDeleteOption, Converter={StaticResource ebc}, ConverterParameter=WholeArchive}"/>
                            <RadioButton Margin="6,3" Content="{l:Loc Key='Options_DoNothing'}" GroupName="deleteArchive"
                                         IsChecked="{Binding ArchiveDeleteOption, Converter={StaticResource ebc}, ConverterParameter=DoNothing}"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_HistoryLists'}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Margin="3,0"
                                     Text="{Binding MaxPathBookmarks, UpdateSourceTrigger=PropertyChanged}"
                                     TextAlignment="Right" PreviewTextInput="TextBox_PreviewTextInput"
                                     DataObject.Pasting="TextBox_Pasting">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <TextBlock Margin="3" Text="{l:Loc Key='Options_ItemsShownInPathHistoryList'}" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Margin="3,0"
                                     Text="{Binding MaxSearchBookmarks, UpdateSourceTrigger=PropertyChanged}"
                                     TextAlignment="Right" PreviewTextInput="TextBox_PreviewTextInput"
                                     DataObject.Pasting="TextBox_Pasting">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <TextBlock Margin="3" Text="{l:Loc Key='Options_ItemsShownInSearchAndReplaceHistoryLists'}" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBox Margin="3,0"
                                     Text="{Binding MaxExtensionBookmarks, UpdateSourceTrigger=PropertyChanged}"
                                     TextAlignment="Right" PreviewTextInput="TextBox_PreviewTextInput"
                                     DataObject.Pasting="TextBox_Pasting">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <TextBlock Margin="3" Text="{l:Loc Key='Options_ItemsShownInFileFilterHistoryLists'}" />
                        </StackPanel>
                        <Button Name="btnClearPreviousSearches" Padding="12,3"
                                Margin="3" HorizontalAlignment="Left"
                                Command="{Binding Path=ClearSearchesCommand}"
                                Content="{l:Loc Key='Options_ClearOldSearches'}"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_RegexOptions'}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Resources>
                                <DataTemplate DataType="{x:Type ValidationError}">
                                    <TextBlock Margin="4,8" HorizontalAlignment="Right" Foreground="Red"
                                               Text="{Binding Path=ErrorContent}" />
                                </DataTemplate>
                            </StackPanel.Resources>
                            <TextBlock Margin="0,0,3,0" Text="{l:Loc Key='Options_MatchTimeout'}" />
                            <TextBox Name="tbMatchTimeout"
                                     Margin="3,0">
                                <TextBox.Text>
                                    <Binding Path="MatchTimeout" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource doubleToString}">
                                        <Binding.ValidationRules>
                                            <my:ValueRangeRule Min="0.001" Max="3600"/>
                                        </Binding.ValidationRules>
                                    </Binding>
                                </TextBox.Text>
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <TextBlock Margin="3,0,0,0" Text="{l:Loc Key='Options_TimeoutSeconds'}" />
                        </StackPanel>
                        <TextBlock Width="440" TextWrapping="Wrap" Text="{l:Loc Key='Options_TheMatchTimeoutLimits'}"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_PhoneticSearch'}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel.Resources>
                                <DataTemplate DataType="{x:Type ValidationError}">
                                    <TextBlock Margin="4,6" HorizontalAlignment="Right" Foreground="Red"
                                               Text="{Binding Path=ErrorContent}" />
                                </DataTemplate>
                            </StackPanel.Resources>
                            <TextBlock Margin="0,0,6,0" Text="{l:Loc Key='Options_MatchThreshold'}" />
                            <TextBox Name="tbFuzzyMatchThreshold">
                                <TextBox.Text>
                                    <Binding Path="MatchThreshold" Mode="TwoWay" 
                                         UpdateSourceTrigger="PropertyChanged" Delay="1250"
                                         Converter="{StaticResource doubleToString}">
                                        <Binding.ValidationRules>
                                            <my:ValueRangeRule Min="0" Max="1"/>
                                        </Binding.ValidationRules>
                                    </Binding>
                                </TextBox.Text>
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                        </StackPanel>
                        <TextBlock Text="{l:Loc Key='Options_MatchEverythingToExactMatch'}" />
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_ArchiveOptions'}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                            <RowDefinition/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                   Text="{l:Loc Key='Options_ArchiveExtensions'}"
                                   VerticalAlignment="Center"/>
                        <Button Grid.Row="0" Grid.Column="1"
                                Content="{l:Loc Key='Options_ArchiveReset'}"
                                Command="{Binding ResetArchiveExtensionsCommand}"
                                Padding="12,1" Margin="20,0" 
                                HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <TextBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                 Margin="0,3,12,3" Height="60" Width="540"
                                 HorizontalAlignment="Left"
                                 Text="{Binding ArchiveExtensions}" TextWrapping="Wrap"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"/>
                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                   Text="{l:Loc Key='Options_OpenTheWholeArchiveForTheseExtensions'}"
                                   VerticalAlignment="Center"/>
                        <TextBox Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                                 Margin="0,3,12,3" Width="540"
                                 HorizontalAlignment="Left"
                                 Text="{Binding ArchiveCustomExtensions}" TextWrapping="Wrap"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"/>
                    </Grid>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_WordDocx'}">
                    <StackPanel Orientation="Vertical">
                        <CheckBox Margin="0,3,0,3" Content="{l:Loc Key='Options_ExtractFootnotes'}"
                                  IsChecked="{Binding WordExtractFootnotes}"/>
                        <StackPanel Margin="0,3,0,0">
                            <TextBlock Text="{l:Loc Key='Options_FootnoteReferenceCharacters'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_NotShown'}" GroupName="wordFootnoteRef"
                                         IsChecked="{Binding WordFootnoteReference, Converter={StaticResource ebc}, ConverterParameter=None}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_Superscipt'}" GroupName="wordFootnoteRef"
                                         ToolTip="{l:Loc Key='Options_MayNotBeSupportedInAllFonts'}"
                                         IsChecked="{Binding WordFootnoteReference, Converter={StaticResource ebc}, ConverterParameter=Superscript}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_FullSizeCharacter'}" GroupName="wordFootnoteRef"
                                         IsChecked="{Binding WordFootnoteReference, Converter={StaticResource ebc}, ConverterParameter=Character}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_FullSizeCharacterInParenthesis'}" GroupName="wordFootnoteRef"
                                         IsChecked="{Binding WordFootnoteReference, Converter={StaticResource ebc}, ConverterParameter=Parenthesis}" />
                        </StackPanel>
                        <CheckBox Margin="0,3,0,3" Content="{l:Loc Key='Options_ExtractComments'}"
                                  IsChecked="{Binding WordExtractComments}"/>
                        <StackPanel Margin="0,3,0,0">
                            <TextBlock Text="{l:Loc Key='Options_CommentReferenceNumbers'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_NotShown'}" GroupName="wordCommentRef"
                                         IsChecked="{Binding WordCommentReference, Converter={StaticResource ebc}, ConverterParameter=None}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_Subscript'}" GroupName="wordCommentRef"
                                         ToolTip="{l:Loc Key='Options_MayNotBeSupportedInAllFonts'}"
                                         IsChecked="{Binding WordCommentReference, Converter={StaticResource ebc}, ConverterParameter=Subscript}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_FullSizeNumberInParenthesis'}" GroupName="wordCommentRef"
                                         IsChecked="{Binding WordCommentReference, Converter={StaticResource ebc}, ConverterParameter=Parenthesis}" />
                        </StackPanel>
                        <CheckBox Margin="0,3,0,3" Content="{l:Loc Key='Options_ExtractHeaders'}"
                                  IsChecked="{Binding WordExtractHeaders}"/>
                        <CheckBox Margin="0,3,0,3" Content="{l:Loc Key='Options_ExtractFooters'}"
                                  IsChecked="{Binding WordExtractFooters}"/>
                        <StackPanel Margin="0,3,0,3">
                            <TextBlock Text="{l:Loc Key='Options_ExtractedHeaderAndFooterPosition'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_SectionStart'}" GroupName="wordHeaderFooterPos"
                                         IsChecked="{Binding WordHeaderFooterPosition, Converter={StaticResource ebc}, ConverterParameter=SectionStart}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_EndOfDocument'}" GroupName="wordHeaderFooterPos"
                                         IsChecked="{Binding WordHeaderFooterPosition, Converter={StaticResource ebc}, ConverterParameter=DocumentEnd}" />
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_PDFToText'}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="252.333"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Row="0" Grid.Column="0" Margin="0,3"
                                   Text="{l:Loc Key='Options_PdfToTextExeCommandLineOptions'}"/>
                        <TextBox Grid.Row="1" Grid.Column="0" 
                                 Text="{Binding PdfToTextOptions, UpdateSourceTrigger=PropertyChanged}" 
                                 Width="350" Margin="0,3"
                                 HorizontalAlignment="Left" />
                        <Button Grid.Row="0" Grid.Column="1" Grid.RowSpan="2" 
                                Content="{l:Loc Key='Options_PdfToTextReset'}" 
                                Command="{Binding ResetPdfToTextOptionCommand}"
                                Padding="12,3" Margin="20,3" 
                                HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        <CheckBox Grid.Row="2" Grid.Column="0" 
                                  Content="{l:Loc Key='Options_MultilineSearch'}"
                                  IsChecked="{Binding PdfJoinLines}"/>
                        <StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,6,0,0">
                            <TextBlock Text="{l:Loc Key='Options_PDFNumberStyle'}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_PageNumbers'}" GroupName="pdfNumber"
                                         IsChecked="{Binding PdfNumberStyle, Converter={StaticResource ebc}, ConverterParameter=PageNumber}" />
                            <RadioButton Margin="18,3" Content="{l:Loc Key='Options_LineNumbers'}" GroupName="pdfNumber"
                                         IsChecked="{Binding PdfNumberStyle, Converter={StaticResource ebc}, ConverterParameter=LineNumber}" />
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_PlugInCache'}">
                    <StackPanel Orientation="Vertical" Margin="0,6,0,0">
                        <CheckBox Content="{l:Loc Key='Options_CacheExtractedFiles'}"
                                  Margin="0,3"
                                  IsChecked="{Binding CacheExtractedFiles}"/>
                        <RadioButton Content="{l:Loc Key='Options_CacheFilesInTempFolder'}"
                                     Margin="0,3"
                                     IsChecked="{Binding CacheFilesInTempFolder}"/>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton Content="{l:Loc Key='Options_CacheFilesIn'}"
                                         Margin="0,3,3,3"
                                         IsChecked="{Binding CacheFilesInTempFolder, Converter={StaticResource not}}"/>
                            <TextBox Margin="3"  
                                     Text="{Binding CacheFilePath, UpdateSourceTrigger=PropertyChanged}" 
                                     IsEnabled="{Binding CacheFilesInTempFolder, Converter={StaticResource not}}"
                                     Width="350"
                                     HorizontalAlignment="Left" />
                            <Button Grid.Column="2" Content="{l:Loc Key='Options_BrowseFileLocation'}" Margin="3"
                                    Command="{Binding Path=BrowseCacheCommand}">
                                <Button.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="32" FallbackValue="32">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </Button.Width>
                            </Button>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Content="{l:Loc Key='Options_DeleteFilesFromCacheIfNotUsedIn'}"
                                      Margin="0,3,3,3"
                                      IsChecked="{Binding CacheFilesClean}"/>
                            <TextBox Margin="3,0"
                                     Text="{Binding CacheFilesCleanDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                     TextAlignment="Right" PreviewTextInput="TextBox_PreviewTextInput"
                                     DataObject.Pasting="TextBox_Pasting"
                                     IsEnabled="{Binding CacheFilesClean}">
                                <TextBox.Width>
                                    <MultiBinding Converter="{StaticResource TextBoxWidthConverter}" ConverterParameter="48" FallbackValue="48">
                                        <Binding RelativeSource="{RelativeSource Mode=Self}"/>
                                        <Binding Path="ApplicationFontFamily"/>
                                        <Binding Path="DialogFontSize"/>
                                    </MultiBinding>
                                </TextBox.Width>
                            </TextBox>
                            <Label Content="{l:Loc Key='Options_CheckDays'}"/>
                        </StackPanel>
                        <TextBlock Text="{l:Loc Key='Options_CreateCacheFileKeyUsing'}"/>
                        <RadioButton Margin="18,3" Content="{l:Loc Key='Options_HashOfFullFile'}"
                                     GroupName="CacheHashType"
                                     IsChecked="{Binding CacheFileHashType, Converter={StaticResource ebc}, ConverterParameter=FullFile}"/>
                        <RadioButton Margin="18,3" Content="{l:Loc Key='Options_HashOfFileSizeAndModifiedTime'}"
                                     GroupName="CacheHashType"
                                     IsChecked="{Binding CacheFileHashType, Converter={StaticResource ebc}, ConverterParameter=SizeTimestamp}"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="{l:Loc Key='Options_PluginOptions'}">
                    <ItemsControl ItemsSource="{Binding Path=Plugins}" Grid.IsSharedSizeScope="True">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" SharedSizeGroup="A"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="400"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding Name}" FontWeight="Bold" Margin="0,3,6,3"/>
                                    <CheckBox Grid.Row="0" Grid.Column="1" Margin="3,0"
                                              Content="{l:Loc Key='Options_PluginEnabled'}" IsChecked="{Binding IsEnabled}"/>
                                    <CheckBox Grid.Row="0" Grid.Column="2" Margin="6,0"
                                              Content="{l:Loc Key='Options_PluginShowPlainTextInPreview'}" IsChecked="{Binding PreviewTextEnabled}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Margin="3,0" VerticalAlignment="Bottom"
                                               Text="{l:Loc Key='Options_PluginExtensions'}"/>
                                    <Button Grid.Row="1" Grid.Column="2"
                                            Content="{l:Loc Key='Options_PluginReset'}"
                                            Command="{Binding ResetExtensions}"
                                            Padding="12,1" Margin="20,0" 
                                            HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Text="{Binding MappedExtensions}" 
                                             Margin="3" HorizontalAlignment="Stretch"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </GroupBox>
            </StackPanel>

        </ScrollViewer>

        <WrapPanel Grid.Row="1" Margin="0,8,0,0" HorizontalAlignment="Left"
                   VerticalAlignment="Center">
            <TextBlock Text="{l:Loc Key='Options_PressF1ForHelpOnOptions'}" HorizontalAlignment="Left"/>
        </WrapPanel>
        <WrapPanel Grid.Row="1" Margin="0,8,0,0" HorizontalAlignment="Right"
                   VerticalAlignment="Bottom">
            <Button x:Name="btnSave" Padding="24,3" Margin="0,5,10,5"
                    IsDefault="True" Content="{l:Loc Key='Options_Save'}"
                    Command="{Binding Path=SaveCommand}" 
                    MinWidth="{Binding ElementName=btnClose, Path=ActualWidth}"/>
            <Button x:Name="btnClose" Padding="24,3" Margin="0,5,15,5"
                    IsCancel="True" Content="{l:Loc Key='Options_Close'}" />
        </WrapPanel>
    </Grid>
</my:ThemedWindow>
